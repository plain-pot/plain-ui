{"version":3,"sources":["webpack://CustomApplicationmain-application/./src/packages/nav/NavigatorManager.tsx","webpack://CustomApplicationmain-application/./node_modules/@babel/runtime/helpers/slicedToArray.js","webpack://CustomApplicationmain-application/./node_modules/import-html-entry/esm/utils.js","webpack://CustomApplicationmain-application/./node_modules/import-html-entry/esm/process-tpl.js","webpack://CustomApplicationmain-application/./node_modules/import-html-entry/esm/index.js","webpack://CustomApplicationmain-application/./node_modules/@babel/runtime/helpers/arrayLikeToArray.js","webpack://CustomApplicationmain-application/./node_modules/@babel/runtime/helpers/unsupportedIterableToArray.js","webpack://CustomApplicationmain-application/./node_modules/@babel/runtime/helpers/typeof.js","webpack://CustomApplicationmain-application/./story/pages/nav/nav.vue","webpack://CustomApplicationmain-application/./story/pages/nav/nav.vue?446a","webpack://CustomApplicationmain-application/./story/pages/nav/nav.vue?4d24","webpack://CustomApplicationmain-application/./node_modules/@babel/runtime/helpers/iterableToArrayLimit.js","webpack://CustomApplicationmain-application/./node_modules/@babel/runtime/helpers/arrayWithHoles.js","webpack://CustomApplicationmain-application/./node_modules/@babel/runtime/helpers/nonIterableRest.js"],"names":["NavRouteMode","nextStackId","nextPageId","createNavigatorManager","config","apps","microAppConfig","map","state","stacks","currentStack","filter","s","show","shift","utils","createPage","pageConfig","id","init","loading","createStack","generateStackId","pages","getAppLoader","app","a","pattern","test","path","console","error","log","name","url","loader","loadWork","dfd","promise","html","assetPublicPath","execScripts","bootstrap","default","resolve","findStack","judgement","find","registryMicroApp","unshift","tabMethods","openTab","newStack","push","showTab","closeTab","refreshTab","getCurrentTab","stackId","hideTab","stack","item","length","current","value","pageMethods","back","pop","redirect","refresh","getCurrentPage","on","off","once","emit","defaultPage","arrayWithHoles","require","iterableToArrayLimit","unsupportedIterableToArray","nonIterableRest","_slicedToArray","arr","i","module","exports","firstGlobalProp","secondGlobalProp","lastGlobalProp","isIE11","navigator","userAgent","indexOf","shouldSkipProperty","global","p","hasOwnProperty","isNaN","window","parent","err","getGlobalProp","lastProp","cnt","hasIframe","frames","frame","noteGlobalProps","undefined","getInlineCode","match","start","end","lastIndexOf","substring","defaultGetPublicPath","entry","_URL","URL","startsWith","concat","location","protocol","href","origin","pathname","paths","split","join","e","warn","isModuleScriptSupported","document","createElement","requestIdleCallback","cb","Date","now","setTimeout","didTimeout","timeRemaining","Math","max","readResAsString","response","autoDetectCharset","text","headers","contentType","get","charset","parts","_parts$1$split","_parts$1$split2","encoding","trim","toUpperCase","blob","then","file","Promise","reject","reader","FileReader","onload","result","onerror","readAsText","ALL_SCRIPT_REGEX","SCRIPT_TAG_REGEX","SCRIPT_SRC_REGEX","SCRIPT_TYPE_REGEX","SCRIPT_ENTRY_REGEX","SCRIPT_ASYNC_REGEX","SCRIPT_NO_MODULE_REGEX","SCRIPT_MODULE_REGEX","LINK_TAG_REGEX","LINK_PRELOAD_OR_PREFETCH_REGEX","LINK_HREF_REGEX","LINK_AS_FONT","STYLE_TAG_REGEX","STYLE_TYPE_REGEX","STYLE_HREF_REGEX","HTML_COMMENT_REGEX","LINK_IGNORE_REGEX","STYLE_IGNORE_REGEX","SCRIPT_IGNORE_REGEX","hasProtocol","getEntirePath","baseURI","toString","isValidJavaScriptType","type","handleTypes","genLinkReplaceSymbol","linkHref","preloadOrPrefetch","arguments","genScriptReplaceSymbol","scriptSrc","async","inlineScriptReplaceSymbol","genIgnoreAssetReplaceSymbol","genModuleScriptReplaceSymbol","moduleSupport","processTpl","tpl","scripts","styles","template","replace","styleType","styleHref","styleIgnore","newHref","preloadOrPrefetchType","_match$match","_match$match2","scriptTag","scriptIgnore","moduleScriptIgnore","matchedScriptTypeMatch","matchedScriptType","matchedScriptEntry","matchedScriptSrcMatch","matchedScriptSrc","SyntaxError","asyncScript","src","code","isPureCommentBlock","every","line","script","styleCache","scriptCache","embedHTMLCache","fetch","Error","defaultFetch","bind","defaultGetTemplate","getEmbedHTML","opts","_opts$fetch","embedHTML","_getExternalStyleSheets","styleSheets","reduce","styleSrc","isInlineCode","getExecutableScript","scriptText","proxy","strictGlobal","sourceUrl","globalWindow","eval","all","styleLink","_getExternalScripts","errorCallback","fetchScript","scriptUrl","status","content","throwNonBlockingError","msg","performance","mark","clearMarks","measure","clearMeasures","_execScripts","_opts$fetch2","_opts$strictGlobal","success","_opts$error","_opts$beforeExec","beforeExec","_opts$afterExec","afterExec","scriptsText","geval","inlineScript","rawCode","exec","downloadedScriptText","schedule","resolvePromise","importHTML","autoDecodeResponse","getPublicPath","getTemplate","fn","getDomain","_processTpl","getExternalScripts","getExternalStyleSheets","execScriptsHooks","_arrayLikeToArray","len","arr2","Array","arrayLikeToArray","_unsupportedIterableToArray","o","minLen","n","Object","prototype","call","slice","constructor","from","_typeof","obj","Symbol","iterator","class","title","label","openButton","nav","height","width","routerMode","hash","data","methods","render","_iterableToArrayLimit","_arr","_n","_d","_e","_s","_i","next","done","_arrayWithHoles","isArray","_nonIterableRest","TypeError"],"mappings":"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","file":"js/chunk-3848d03b.046cb4eb.js","sourcesContent":["import {reactive, computed} from 'vue';\r\nimport {createCounter} from \"../../utils/createCounter\";\r\nimport {MicroApp, MicroAppConfig, MicroAppLoader} from \"../../../pro/micro.app\";\r\nimport {$$notice} from \"../notice-service\";\r\nimport importHTML from 'import-html-entry';\r\nimport {defer} from \"../../utils/defer\";\r\n\r\nconst nextStackId = createCounter('navigator_stack')\r\nconst nextPageId = createCounter('navigator_page')\r\n\r\n/*路由模式*/\r\nexport enum NavRouteMode {\r\n    hash = 'hash',\r\n    history = 'history',\r\n}\r\n\r\n/*生成stack的唯一标识的id*/\r\ntype GenerateStackId = (pageConfig: PageConfig) => string\r\n/*获取页面组件对象*/\r\nexport type GetPage = (pageConfig: PageConfig) => Promise<any>\r\n/*打开页面的时候的标题*/\r\ntype PageConfigTitle = string | ((pageConfig: PageConfig) => string)\r\n\r\n/*跳转页面信息*/\r\nexport interface PageConfig<DATA = any> {\r\n    title: PageConfigTitle,                                     // 页面标题\r\n    path: string,                                               // 第一个页面的路径\r\n    icon?: string,                                              // 图标\r\n    param?: string,                                             // 页面参数（动态路由参数也是放这里边的）\r\n    query?: Record<string, any>,                                // 路由的query参数\r\n    data?: DATA,                                                 // 额外的数据\r\n}\r\n\r\n/*Page在Stack中具体信息*/\r\nexport interface Page<DATA = any> {\r\n    id: string,                                                 // 页面标识\r\n    pageConfig: PageConfig<DATA>,                                     // 页面信息\r\n    init: boolean,                                              // 页面是否已经初始化\r\n    loading: boolean,                                           // 页面是否处于加载状态\r\n}\r\n\r\n/*页面栈信息*/\r\nexport interface Stack<DATA = any> {\r\n    id: string,                                                 // 页面栈id\r\n    pageConfig: PageConfig<DATA>,                                     // 页面栈初始化的page\r\n    pages: Page[],                                              // 页面栈数组\r\n    show: boolean,                                              // 页面栈是否显示\r\n}\r\n\r\n/*创建NavigatorManager的配置参数*/\r\ninterface NavigatorManagerConfig {\r\n    routerMode: NavRouteMode,                                   // 路由模式，解析url的时候是哈希路由还是history路由\r\n    defaultPage: PageConfig,                                    // 当没有指定路由，也没有缓存的页面时，默认打开的页面\r\n    storageKey?: string,                                        // 多页面应用中可能会存在缓存冲突的问题。通过这个属性可以隔离多页面应用之间的缓存\r\n    maxStack?: number,                                          // 最大的可以打开的stack个数\r\n    generateStackId?: GenerateStackId,                          // 生成StackId的函数\r\n    microAppConfig?: MicroAppConfig[],\r\n}\r\n\r\nexport function createNavigatorManager(config: NavigatorManagerConfig) {\r\n\r\n    const apps: MicroApp[] = (config.microAppConfig || []).map(config => ({config}))\r\n    const state = reactive({stacks: [] as Stack[],})\r\n    /*当前正在显示的tab*/\r\n    const currentStack = computed(() => state.stacks.filter(s => s.show).shift())\r\n\r\n    /*---------------------------------------utils-------------------------------------------*/\r\n\r\n    const utils = {\r\n        /*创建Page*/\r\n        createPage: (pageConfig: PageConfig): Page => {\r\n            return {\r\n                id: nextPageId(),\r\n                pageConfig,\r\n                init: false,\r\n                loading: false,\r\n            }\r\n        },\r\n        /*创建Stack*/\r\n        createStack: (pageConfig: PageConfig): Stack => {\r\n            return {\r\n                id: (config.generateStackId || nextStackId)(pageConfig),\r\n                pageConfig: pageConfig,\r\n                pages: [utils.createPage(pageConfig),],\r\n                show: false,\r\n            }\r\n        },\r\n        /*获取页面加载器*/\r\n        getAppLoader: async (pageConfig: PageConfig): Promise<MicroAppLoader | undefined> => {\r\n            const app = apps.filter(a => a.config.pattern.test(pageConfig.path)).shift()\r\n            if (!app) {\r\n                console.error('无子应用可以处理该页面！', pageConfig)\r\n                return\r\n            }\r\n            console.log('匹配子应用：', {app: app.config.name, url: pageConfig.path})\r\n            if (!!app.config.loader) {return app.config.loader}\r\n            if (!app.config.url) {\r\n                console.error('子应用信息错误，app.config.url 以及 app.config.loader 不能同时为空')\r\n                return\r\n            }\r\n            if (!app.loader) {\r\n                try {\r\n                    if (!!app.loadWork) {\r\n                        await app.loadWork\r\n                    } else {\r\n                        console.log('加载子应用', app.config.name)\r\n                        const dfd = defer<MicroAppLoader>()\r\n                        app.loadWork = dfd.promise\r\n                        const html = await importHTML(app.config.url!)\r\n                        app.assetPublicPath = html.assetPublicPath\r\n                        const bootstrap = ((await html.execScripts()) as any).default\r\n                        app.loader = await bootstrap(app)\r\n                        dfd.resolve(app.loader!);\r\n                    }\r\n                } catch (e) {\r\n                    $$notice.error(`加载子应用【${app.config.name}】失败！`)\r\n                    throw  e\r\n                }\r\n            }\r\n            return app.loader!\r\n        },\r\n        /*查找一个Stack*/\r\n        findStack<DATA = any>(judgement: (stack: Stack<DATA>) => boolean): Stack<DATA> | undefined {\r\n            return state.stacks.find(judgement)\r\n        },\r\n        registryMicroApp: (config: MicroAppConfig) => {\r\n            apps.unshift({config})\r\n        },\r\n    }\r\n    const tabMethods = {\r\n        /*打开一个tab*/\r\n        openTab: async (pageConfig: PageConfig) => {\r\n            const newStack = utils.createStack(pageConfig)\r\n            state.stacks.push(newStack)\r\n            await tabMethods.showTab(newStack.id)\r\n        },\r\n        /*关闭tab*/\r\n        closeTab: () => {/*todo*/},\r\n        /*刷新tab*/\r\n        refreshTab: () => {/*todo*/},\r\n        /*获取当前tab*/\r\n        getCurrentTab: () => {/*todo*/},\r\n        /*显示tab*/\r\n        showTab: async (stackId: string) => {\r\n            await tabMethods.hideTab()\r\n            const stack = state.stacks.find(item => item.id === stackId)\r\n            if (!!stack) {\r\n                stack.show = true\r\n                /*渲染最后两个页面*/\r\n                if (stack.pages.length > 0 && !stack.pages[stack.pages.length - 1].init) {\r\n                    stack.pages[stack.pages.length - 1].init = true\r\n                }\r\n                if (stack.pages.length > 1 && !stack.pages[stack.pages.length - 2].init) {\r\n                    stack.pages[stack.pages.length - 2].init = true\r\n                }\r\n            }\r\n        },\r\n        /*隐藏当前显示的tab*/\r\n        hideTab: async () => {\r\n            const current = currentStack.value\r\n            if (!!current) {\r\n                current.show = false\r\n            }\r\n        },\r\n    }\r\n    const pageMethods = {\r\n        /*push一个页面*/\r\n        push: (stack: Stack, pageConfig: PageConfig) => {\r\n            stack.pages.push(utils.createPage(pageConfig))\r\n        },\r\n        /*pop一个页面*/\r\n        back: (stack: Stack) => {\r\n            stack.pages.length > 1 && stack.pages.pop()\r\n        },\r\n        /*重定向到一个页面*/\r\n        redirect: () => {/*todo*/},\r\n        /*刷新页面*/\r\n        refresh: () => {/*todo*/},\r\n        /*开启/关闭页面的加载状态*/\r\n        loading: () => {/*todo*/},\r\n        /*获取当前页面信息*/\r\n        getCurrentPage: () => {/*todo*/},\r\n        /*监听事件*/\r\n        on: () => {/*todo*/},\r\n        /*解除监听事件*/\r\n        off: () => {/*todo*/},\r\n        /*监听一次事件*/\r\n        once: () => {/*todo*/},\r\n        /*派发事件*/\r\n        emit: () => {/*todo*/},\r\n    }\r\n\r\n    /*执行初始化逻辑*/\r\n    const init = async () => {\r\n        /*根据路由地址初始化*/\r\n        /*根据缓存初始化*/\r\n        /*根据defaultPage初始化*/\r\n        await tabMethods.openTab(config.defaultPage)\r\n    }\r\n\r\n    return reactive({\r\n        state,\r\n        currentStack,\r\n        utils,\r\n        tabMethods,\r\n        pageMethods,\r\n        ...tabMethods,\r\n        registryMicroApp: utils.registryMicroApp,\r\n        init,\r\n    })\r\n}\r\n\r\nexport type NavigatorManager = ReturnType<typeof createNavigatorManager>","var arrayWithHoles = require(\"./arrayWithHoles\");\n\nvar iterableToArrayLimit = require(\"./iterableToArrayLimit\");\n\nvar unsupportedIterableToArray = require(\"./unsupportedIterableToArray\");\n\nvar nonIterableRest = require(\"./nonIterableRest\");\n\nfunction _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || unsupportedIterableToArray(arr, i) || nonIterableRest();\n}\n\nmodule.exports = _slicedToArray;","import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _typeof from \"@babel/runtime/helpers/typeof\";\n\n/**\n * @author Kuitos\n * @homepage https://github.com/kuitos/\n * @since 2019-02-25\n * fork from https://github.com/systemjs/systemjs/blob/master/src/extras/global.js\n */\nvar isIE11 = typeof navigator !== 'undefined' && navigator.userAgent.indexOf('Trident') !== -1;\n\nfunction shouldSkipProperty(global, p) {\n  if (!global.hasOwnProperty(p) || !isNaN(p) && p < global.length) return true;\n\n  if (isIE11) {\n    // https://github.com/kuitos/import-html-entry/pull/32，最小化 try 范围\n    try {\n      return global[p] && typeof window !== 'undefined' && global[p].parent === window;\n    } catch (err) {\n      return true;\n    }\n  } else {\n    return false;\n  }\n} // safari unpredictably lists some new globals first or second in object order\n\n\nvar firstGlobalProp, secondGlobalProp, lastGlobalProp;\nexport function getGlobalProp(global) {\n  var cnt = 0;\n  var lastProp;\n  var hasIframe = false;\n\n  for (var p in global) {\n    if (shouldSkipProperty(global, p)) continue; // 遍历 iframe，检查 window 上的属性值是否是 iframe，是则跳过后面的 first 和 second 判断\n\n    for (var i = 0; i < window.frames.length && !hasIframe; i++) {\n      var frame = window.frames[i];\n\n      if (frame === global[p]) {\n        hasIframe = true;\n        break;\n      }\n    }\n\n    if (!hasIframe && (cnt === 0 && p !== firstGlobalProp || cnt === 1 && p !== secondGlobalProp)) return p;\n    cnt++;\n    lastProp = p;\n  }\n\n  if (lastProp !== lastGlobalProp) return lastProp;\n}\nexport function noteGlobalProps(global) {\n  // alternatively Object.keys(global).pop()\n  // but this may be faster (pending benchmarks)\n  firstGlobalProp = secondGlobalProp = undefined;\n\n  for (var p in global) {\n    if (shouldSkipProperty(global, p)) continue;\n    if (!firstGlobalProp) firstGlobalProp = p;else if (!secondGlobalProp) secondGlobalProp = p;\n    lastGlobalProp = p;\n  }\n\n  return lastGlobalProp;\n}\nexport function getInlineCode(match) {\n  var start = match.indexOf('>') + 1;\n  var end = match.lastIndexOf('<');\n  return match.substring(start, end);\n}\nexport function defaultGetPublicPath(entry) {\n  if (_typeof(entry) === 'object') {\n    return '/';\n  }\n\n  try {\n    // URL 构造函数不支持使用 // 前缀的 url\n    var _URL = new URL(entry.startsWith('//') ? \"\".concat(location.protocol).concat(entry) : entry, location.href),\n        origin = _URL.origin,\n        pathname = _URL.pathname;\n\n    var paths = pathname.split('/'); // 移除最后一个元素\n\n    paths.pop();\n    return \"\".concat(origin).concat(paths.join('/'), \"/\");\n  } catch (e) {\n    console.warn(e);\n    return '';\n  }\n} // Detect whether browser supports `<script type=module>` or not\n\nexport function isModuleScriptSupported() {\n  var s = document.createElement('script');\n  return 'noModule' in s;\n} // RIC and shim for browsers setTimeout() without it\n\nexport var requestIdleCallback = window.requestIdleCallback || function requestIdleCallback(cb) {\n  var start = Date.now();\n  return setTimeout(function () {\n    cb({\n      didTimeout: false,\n      timeRemaining: function timeRemaining() {\n        return Math.max(0, 50 - (Date.now() - start));\n      }\n    });\n  }, 1);\n};\nexport function readResAsString(response, autoDetectCharset) {\n  // 未启用自动检测\n  if (!autoDetectCharset) {\n    return response.text();\n  } // 如果没headers，发生在test环境下的mock数据，为兼容原有测试用例\n\n\n  if (!response.headers) {\n    return response.text();\n  } // 如果没返回content-type，走默认逻辑\n\n\n  var contentType = response.headers.get('Content-Type');\n\n  if (!contentType) {\n    return response.text();\n  } // 解析content-type内的charset\n  // Content-Type: text/html; charset=utf-8\n  // Content-Type: multipart/form-data; boundary=something\n  // GET请求下不会出现第二种content-type\n\n\n  var charset = 'utf-8';\n  var parts = contentType.split(';');\n\n  if (parts.length === 2) {\n    var _parts$1$split = parts[1].split('='),\n        _parts$1$split2 = _slicedToArray(_parts$1$split, 2),\n        value = _parts$1$split2[1];\n\n    var encoding = value && value.trim();\n\n    if (encoding) {\n      charset = encoding;\n    }\n  } // 如果还是utf-8，那么走默认，兼容原有逻辑，这段代码删除也应该工作\n\n\n  if (charset.toUpperCase() === 'UTF-8') {\n    return response.text();\n  } // 走流读取，编码可能是gbk，gb2312等，比如sofa 3默认是gbk编码\n\n\n  return response.blob().then(function (file) {\n    return new Promise(function (resolve, reject) {\n      var reader = new window.FileReader();\n\n      reader.onload = function () {\n        resolve(reader.result);\n      };\n\n      reader.onerror = reject;\n      reader.readAsText(file, charset);\n    });\n  });\n}","import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\n\n/**\n * @author Kuitos\n * @homepage https://github.com/kuitos/\n * @since 2018-09-03 15:04\n */\nimport { getInlineCode, isModuleScriptSupported } from './utils';\nvar ALL_SCRIPT_REGEX = /(<script[\\s\\S]*?>)[\\s\\S]*?<\\/script>/gi;\nvar SCRIPT_TAG_REGEX = /<(script)[\\t-\\r \\xA0\\u1680\\u2000-\\u200A\\u2028\\u2029\\u202F\\u205F\\u3000\\uFEFF]+((?!type=('|')text\\/ng\\x2Dtemplate\\3)[\\s\\S])*?>[\\s\\S]*?<\\/\\1>/i;\nvar SCRIPT_SRC_REGEX = /.*\\ssrc=('|\")?([^>'\"\\s]+)/;\nvar SCRIPT_TYPE_REGEX = /.*\\stype=('|\")?([^>'\"\\s]+)/;\nvar SCRIPT_ENTRY_REGEX = /.*\\sentry\\s*.*/;\nvar SCRIPT_ASYNC_REGEX = /.*\\sasync\\s*.*/;\nvar SCRIPT_NO_MODULE_REGEX = /.*\\snomodule\\s*.*/;\nvar SCRIPT_MODULE_REGEX = /.*\\stype=('|\")?module('|\")?\\s*.*/;\nvar LINK_TAG_REGEX = /<(link)[\\t-\\r \\xA0\\u1680\\u2000-\\u200A\\u2028\\u2029\\u202F\\u205F\\u3000\\uFEFF]+[\\s\\S]*?>/ig;\nvar LINK_PRELOAD_OR_PREFETCH_REGEX = /\\srel=('|\")?(preload|prefetch)\\1/;\nvar LINK_HREF_REGEX = /.*\\shref=('|\")?([^>'\"\\s]+)/;\nvar LINK_AS_FONT = /.*\\sas=('|\")?font\\1.*/;\nvar STYLE_TAG_REGEX = /<style[^>]*>[\\s\\S]*?<\\/style>/gi;\nvar STYLE_TYPE_REGEX = /\\s+rel=('|\")?stylesheet\\1.*/;\nvar STYLE_HREF_REGEX = /.*\\shref=('|\")?([^>'\"\\s]+)/;\nvar HTML_COMMENT_REGEX = /<!--([\\s\\S]*?)-->/g;\nvar LINK_IGNORE_REGEX = /<link([\\t-\\r \\xA0\\u1680\\u2000-\\u200A\\u2028\\u2029\\u202F\\u205F\\u3000\\uFEFF]+|[\\t-\\r \\xA0\\u1680\\u2000-\\u200A\\u2028\\u2029\\u202F\\u205F\\u3000\\uFEFF]+[\\s\\S]+[\\t-\\r \\xA0\\u1680\\u2000-\\u200A\\u2028\\u2029\\u202F\\u205F\\u3000\\uFEFF]+)ignore([\\t-\\r \\xA0\\u1680\\u2000-\\u200A\\u2028\\u2029\\u202F\\u205F\\u3000\\uFEFF]*|[\\t-\\r \\xA0\\u1680\\u2000-\\u200A\\u2028\\u2029\\u202F\\u205F\\u3000\\uFEFF]+[\\s\\S]*|=[\\s\\S]*)>/i;\nvar STYLE_IGNORE_REGEX = /<style([\\t-\\r \\xA0\\u1680\\u2000-\\u200A\\u2028\\u2029\\u202F\\u205F\\u3000\\uFEFF]+|[\\t-\\r \\xA0\\u1680\\u2000-\\u200A\\u2028\\u2029\\u202F\\u205F\\u3000\\uFEFF]+[\\s\\S]+[\\t-\\r \\xA0\\u1680\\u2000-\\u200A\\u2028\\u2029\\u202F\\u205F\\u3000\\uFEFF]+)ignore([\\t-\\r \\xA0\\u1680\\u2000-\\u200A\\u2028\\u2029\\u202F\\u205F\\u3000\\uFEFF]*|[\\t-\\r \\xA0\\u1680\\u2000-\\u200A\\u2028\\u2029\\u202F\\u205F\\u3000\\uFEFF]+[\\s\\S]*|=[\\s\\S]*)>/i;\nvar SCRIPT_IGNORE_REGEX = /<script([\\t-\\r \\xA0\\u1680\\u2000-\\u200A\\u2028\\u2029\\u202F\\u205F\\u3000\\uFEFF]+|[\\t-\\r \\xA0\\u1680\\u2000-\\u200A\\u2028\\u2029\\u202F\\u205F\\u3000\\uFEFF]+[\\s\\S]+[\\t-\\r \\xA0\\u1680\\u2000-\\u200A\\u2028\\u2029\\u202F\\u205F\\u3000\\uFEFF]+)ignore([\\t-\\r \\xA0\\u1680\\u2000-\\u200A\\u2028\\u2029\\u202F\\u205F\\u3000\\uFEFF]*|[\\t-\\r \\xA0\\u1680\\u2000-\\u200A\\u2028\\u2029\\u202F\\u205F\\u3000\\uFEFF]+[\\s\\S]*|=[\\s\\S]*)>/i;\n\nfunction hasProtocol(url) {\n  return url.startsWith('//') || url.startsWith('http://') || url.startsWith('https://');\n}\n\nfunction getEntirePath(path, baseURI) {\n  return new URL(path, baseURI).toString();\n}\n\nfunction isValidJavaScriptType(type) {\n  var handleTypes = ['text/javascript', 'module', 'application/javascript', 'text/ecmascript', 'application/ecmascript'];\n  return !type || handleTypes.indexOf(type) !== -1;\n}\n\nexport var genLinkReplaceSymbol = function genLinkReplaceSymbol(linkHref) {\n  var preloadOrPrefetch = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n  return \"<!-- \".concat(preloadOrPrefetch ? 'prefetch/preload' : '', \" link \").concat(linkHref, \" replaced by import-html-entry -->\");\n};\nexport var genScriptReplaceSymbol = function genScriptReplaceSymbol(scriptSrc) {\n  var async = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n  return \"<!-- \".concat(async ? 'async' : '', \" script \").concat(scriptSrc, \" replaced by import-html-entry -->\");\n};\nexport var inlineScriptReplaceSymbol = \"<!-- inline scripts replaced by import-html-entry -->\";\nexport var genIgnoreAssetReplaceSymbol = function genIgnoreAssetReplaceSymbol(url) {\n  return \"<!-- ignore asset \".concat(url || 'file', \" replaced by import-html-entry -->\");\n};\nexport var genModuleScriptReplaceSymbol = function genModuleScriptReplaceSymbol(scriptSrc, moduleSupport) {\n  return \"<!-- \".concat(moduleSupport ? 'nomodule' : 'module', \" script \").concat(scriptSrc, \" ignored by import-html-entry -->\");\n};\n/**\n * parse the script link from the template\n * 1. collect stylesheets\n * 2. use global eval to evaluate the inline scripts\n *    see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function#Difference_between_Function_constructor_and_function_declaration\n *    see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/eval#Do_not_ever_use_eval!\n * @param tpl\n * @param baseURI\n * @stripStyles whether to strip the css links\n * @returns {{template: void | string | *, scripts: *[], entry: *}}\n */\n\nexport default function processTpl(tpl, baseURI) {\n  var scripts = [];\n  var styles = [];\n  var entry = null;\n  var moduleSupport = isModuleScriptSupported();\n  var template = tpl\n  /*\n  remove html comment first\n  */\n  .replace(HTML_COMMENT_REGEX, '').replace(LINK_TAG_REGEX, function (match) {\n    /*\n    change the css link\n    */\n    var styleType = !!match.match(STYLE_TYPE_REGEX);\n\n    if (styleType) {\n      var styleHref = match.match(STYLE_HREF_REGEX);\n      var styleIgnore = match.match(LINK_IGNORE_REGEX);\n\n      if (styleHref) {\n        var href = styleHref && styleHref[2];\n        var newHref = href;\n\n        if (href && !hasProtocol(href)) {\n          newHref = getEntirePath(href, baseURI);\n        }\n\n        if (styleIgnore) {\n          return genIgnoreAssetReplaceSymbol(newHref);\n        }\n\n        styles.push(newHref);\n        return genLinkReplaceSymbol(newHref);\n      }\n    }\n\n    var preloadOrPrefetchType = match.match(LINK_PRELOAD_OR_PREFETCH_REGEX) && match.match(LINK_HREF_REGEX) && !match.match(LINK_AS_FONT);\n\n    if (preloadOrPrefetchType) {\n      var _match$match = match.match(LINK_HREF_REGEX),\n          _match$match2 = _slicedToArray(_match$match, 3),\n          linkHref = _match$match2[2];\n\n      return genLinkReplaceSymbol(linkHref, true);\n    }\n\n    return match;\n  }).replace(STYLE_TAG_REGEX, function (match) {\n    if (STYLE_IGNORE_REGEX.test(match)) {\n      return genIgnoreAssetReplaceSymbol('style file');\n    }\n\n    return match;\n  }).replace(ALL_SCRIPT_REGEX, function (match, scriptTag) {\n    var scriptIgnore = scriptTag.match(SCRIPT_IGNORE_REGEX);\n    var moduleScriptIgnore = moduleSupport && !!scriptTag.match(SCRIPT_NO_MODULE_REGEX) || !moduleSupport && !!scriptTag.match(SCRIPT_MODULE_REGEX); // in order to keep the exec order of all javascripts\n\n    var matchedScriptTypeMatch = scriptTag.match(SCRIPT_TYPE_REGEX);\n    var matchedScriptType = matchedScriptTypeMatch && matchedScriptTypeMatch[2];\n\n    if (!isValidJavaScriptType(matchedScriptType)) {\n      return match;\n    } // if it is a external script\n\n\n    if (SCRIPT_TAG_REGEX.test(match) && scriptTag.match(SCRIPT_SRC_REGEX)) {\n      /*\n      collect scripts and replace the ref\n      */\n      var matchedScriptEntry = scriptTag.match(SCRIPT_ENTRY_REGEX);\n      var matchedScriptSrcMatch = scriptTag.match(SCRIPT_SRC_REGEX);\n      var matchedScriptSrc = matchedScriptSrcMatch && matchedScriptSrcMatch[2];\n\n      if (entry && matchedScriptEntry) {\n        throw new SyntaxError('You should not set multiply entry script!');\n      } else {\n        // append the domain while the script not have an protocol prefix\n        if (matchedScriptSrc && !hasProtocol(matchedScriptSrc)) {\n          matchedScriptSrc = getEntirePath(matchedScriptSrc, baseURI);\n        }\n\n        entry = entry || matchedScriptEntry && matchedScriptSrc;\n      }\n\n      if (scriptIgnore) {\n        return genIgnoreAssetReplaceSymbol(matchedScriptSrc || 'js file');\n      }\n\n      if (moduleScriptIgnore) {\n        return genModuleScriptReplaceSymbol(matchedScriptSrc || 'js file', moduleSupport);\n      }\n\n      if (matchedScriptSrc) {\n        var asyncScript = !!scriptTag.match(SCRIPT_ASYNC_REGEX);\n        scripts.push(asyncScript ? {\n          async: true,\n          src: matchedScriptSrc\n        } : matchedScriptSrc);\n        return genScriptReplaceSymbol(matchedScriptSrc, asyncScript);\n      }\n\n      return match;\n    } else {\n      if (scriptIgnore) {\n        return genIgnoreAssetReplaceSymbol('js file');\n      }\n\n      if (moduleScriptIgnore) {\n        return genModuleScriptReplaceSymbol('js file', moduleSupport);\n      } // if it is an inline script\n\n\n      var code = getInlineCode(match); // remove script blocks when all of these lines are comments.\n\n      var isPureCommentBlock = code.split(/[\\r\\n]+/).every(function (line) {\n        return !line.trim() || line.trim().startsWith('//');\n      });\n\n      if (!isPureCommentBlock) {\n        scripts.push(match);\n      }\n\n      return inlineScriptReplaceSymbol;\n    }\n  });\n  scripts = scripts.filter(function (script) {\n    // filter empty script\n    return !!script;\n  });\n  return {\n    template: template,\n    scripts: scripts,\n    styles: styles,\n    // set the last script as entry if have not set\n    entry: entry || scripts[scripts.length - 1]\n  };\n}","/**\n * @author Kuitos\n * @homepage https://github.com/kuitos/\n * @since 2018-08-15 11:37\n */\nimport processTpl, { genLinkReplaceSymbol, genScriptReplaceSymbol } from './process-tpl';\nimport { readResAsString, defaultGetPublicPath, getGlobalProp, getInlineCode, noteGlobalProps, requestIdleCallback } from './utils';\nvar styleCache = {};\nvar scriptCache = {};\nvar embedHTMLCache = {};\n\nif (!window.fetch) {\n  throw new Error('[import-html-entry] Here is no \"fetch\" on the window env, you need to polyfill it');\n}\n\nvar defaultFetch = window.fetch.bind(window);\n\nfunction defaultGetTemplate(tpl) {\n  return tpl;\n}\n/**\n * convert external css link to inline style for performance optimization\n * @param template\n * @param styles\n * @param opts\n * @return embedHTML\n */\n\n\nfunction getEmbedHTML(template, styles) {\n  var opts = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  var _opts$fetch = opts.fetch,\n      fetch = _opts$fetch === void 0 ? defaultFetch : _opts$fetch;\n  var embedHTML = template;\n  return _getExternalStyleSheets(styles, fetch).then(function (styleSheets) {\n    embedHTML = styles.reduce(function (html, styleSrc, i) {\n      html = html.replace(genLinkReplaceSymbol(styleSrc), \"<style>/* \".concat(styleSrc, \" */\").concat(styleSheets[i], \"</style>\"));\n      return html;\n    }, embedHTML);\n    return embedHTML;\n  });\n}\n\nvar isInlineCode = function isInlineCode(code) {\n  return code.startsWith('<');\n};\n\nfunction getExecutableScript(scriptSrc, scriptText, proxy, strictGlobal) {\n  var sourceUrl = isInlineCode(scriptSrc) ? '' : \"//# sourceURL=\".concat(scriptSrc, \"\\n\"); // 通过这种方式获取全局 window，因为 script 也是在全局作用域下运行的，所以我们通过 window.proxy 绑定时也必须确保绑定到全局 window 上\n  // 否则在嵌套场景下， window.proxy 设置的是内层应用的 window，而代码其实是在全局作用域运行的，会导致闭包里的 window.proxy 取的是最外层的微应用的 proxy\n\n  var globalWindow = (0, eval)('window');\n  globalWindow.proxy = proxy; // TODO 通过 strictGlobal 方式切换切换 with 闭包，待 with 方式坑趟平后再合并\n\n  return strictGlobal ? \";(function(window, self){with(window){;\".concat(scriptText, \"\\n\").concat(sourceUrl, \"}}).bind(window.proxy)(window.proxy, window.proxy);\") : \";(function(window, self){;\".concat(scriptText, \"\\n\").concat(sourceUrl, \"}).bind(window.proxy)(window.proxy, window.proxy);\");\n} // for prefetch\n\n\nfunction _getExternalStyleSheets(styles) {\n  var fetch = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : defaultFetch;\n  return Promise.all(styles.map(function (styleLink) {\n    if (isInlineCode(styleLink)) {\n      // if it is inline style\n      return getInlineCode(styleLink);\n    } else {\n      // external styles\n      return styleCache[styleLink] || (styleCache[styleLink] = fetch(styleLink).then(function (response) {\n        return response.text();\n      }));\n    }\n  }));\n} // for prefetch\n\n\nexport { _getExternalStyleSheets as getExternalStyleSheets };\n\nfunction _getExternalScripts(scripts) {\n  var fetch = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : defaultFetch;\n  var errorCallback = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : function () {};\n\n  var fetchScript = function fetchScript(scriptUrl) {\n    return scriptCache[scriptUrl] || (scriptCache[scriptUrl] = fetch(scriptUrl).then(function (response) {\n      // usually browser treats 4xx and 5xx response of script loading as an error and will fire a script error event\n      // https://stackoverflow.com/questions/5625420/what-http-headers-responses-trigger-the-onerror-handler-on-a-script-tag/5625603\n      if (response.status >= 400) {\n        errorCallback();\n        throw new Error(\"\".concat(scriptUrl, \" load failed with status \").concat(response.status));\n      }\n\n      return response.text();\n    }));\n  };\n\n  return Promise.all(scripts.map(function (script) {\n    if (typeof script === 'string') {\n      if (isInlineCode(script)) {\n        // if it is inline script\n        return getInlineCode(script);\n      } else {\n        // external script\n        return fetchScript(script);\n      }\n    } else {\n      // use idle time to load async script\n      var src = script.src,\n          async = script.async;\n\n      if (async) {\n        return {\n          src: src,\n          async: true,\n          content: new Promise(function (resolve, reject) {\n            return requestIdleCallback(function () {\n              return fetchScript(src).then(resolve, reject);\n            });\n          })\n        };\n      }\n\n      return fetchScript(src);\n    }\n  }));\n}\n\nexport { _getExternalScripts as getExternalScripts };\n\nfunction throwNonBlockingError(error, msg) {\n  setTimeout(function () {\n    console.error(msg);\n    throw error;\n  });\n}\n\nvar supportsUserTiming = typeof performance !== 'undefined' && typeof performance.mark === 'function' && typeof performance.clearMarks === 'function' && typeof performance.measure === 'function' && typeof performance.clearMeasures === 'function';\n/**\n * FIXME to consistent with browser behavior, we should only provide callback way to invoke success and error event\n * @param entry\n * @param scripts\n * @param proxy\n * @param opts\n * @returns {Promise<unknown>}\n */\n\nfunction _execScripts(entry, scripts) {\n  var proxy = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : window;\n  var opts = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n  var _opts$fetch2 = opts.fetch,\n      fetch = _opts$fetch2 === void 0 ? defaultFetch : _opts$fetch2,\n      _opts$strictGlobal = opts.strictGlobal,\n      strictGlobal = _opts$strictGlobal === void 0 ? false : _opts$strictGlobal,\n      success = opts.success,\n      _opts$error = opts.error,\n      error = _opts$error === void 0 ? function () {} : _opts$error,\n      _opts$beforeExec = opts.beforeExec,\n      beforeExec = _opts$beforeExec === void 0 ? function () {} : _opts$beforeExec,\n      _opts$afterExec = opts.afterExec,\n      afterExec = _opts$afterExec === void 0 ? function () {} : _opts$afterExec;\n  return _getExternalScripts(scripts, fetch, error).then(function (scriptsText) {\n    var geval = function geval(scriptSrc, inlineScript) {\n      var rawCode = beforeExec(inlineScript, scriptSrc) || inlineScript;\n      var code = getExecutableScript(scriptSrc, rawCode, proxy, strictGlobal);\n      (0, eval)(code);\n      afterExec(inlineScript, scriptSrc);\n    };\n\n    function exec(scriptSrc, inlineScript, resolve) {\n      var markName = \"Evaluating script \".concat(scriptSrc);\n      var measureName = \"Evaluating Time Consuming: \".concat(scriptSrc);\n\n      if (process.env.NODE_ENV === 'development' && supportsUserTiming) {\n        performance.mark(markName);\n      }\n\n      if (scriptSrc === entry) {\n        noteGlobalProps(strictGlobal ? proxy : window);\n\n        try {\n          // bind window.proxy to change `this` reference in script\n          geval(scriptSrc, inlineScript);\n          var exports = proxy[getGlobalProp(strictGlobal ? proxy : window)] || {};\n          resolve(exports);\n        } catch (e) {\n          // entry error must be thrown to make the promise settled\n          console.error(\"[import-html-entry]: error occurs while executing entry script \".concat(scriptSrc));\n          throw e;\n        }\n      } else {\n        if (typeof inlineScript === 'string') {\n          try {\n            // bind window.proxy to change `this` reference in script\n            geval(scriptSrc, inlineScript);\n          } catch (e) {\n            // consistent with browser behavior, any independent script evaluation error should not block the others\n            throwNonBlockingError(e, \"[import-html-entry]: error occurs while executing normal script \".concat(scriptSrc));\n          }\n        } else {\n          // external script marked with async\n          inlineScript.async && (inlineScript === null || inlineScript === void 0 ? void 0 : inlineScript.content.then(function (downloadedScriptText) {\n            return geval(inlineScript.src, downloadedScriptText);\n          })[\"catch\"](function (e) {\n            throwNonBlockingError(e, \"[import-html-entry]: error occurs while executing async script \".concat(inlineScript.src));\n          }));\n        }\n      }\n\n      if (process.env.NODE_ENV === 'development' && supportsUserTiming) {\n        performance.measure(measureName, markName);\n        performance.clearMarks(markName);\n        performance.clearMeasures(measureName);\n      }\n    }\n\n    function schedule(i, resolvePromise) {\n      if (i < scripts.length) {\n        var scriptSrc = scripts[i];\n        var inlineScript = scriptsText[i];\n        exec(scriptSrc, inlineScript, resolvePromise); // resolve the promise while the last script executed and entry not provided\n\n        if (!entry && i === scripts.length - 1) {\n          resolvePromise();\n        } else {\n          schedule(i + 1, resolvePromise);\n        }\n      }\n    }\n\n    return new Promise(function (resolve) {\n      return schedule(0, success || resolve);\n    });\n  });\n}\n\nexport { _execScripts as execScripts };\nexport default function importHTML(url) {\n  var opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var fetch = defaultFetch;\n  var autoDecodeResponse = false;\n  var getPublicPath = defaultGetPublicPath;\n  var getTemplate = defaultGetTemplate; // compatible with the legacy importHTML api\n\n  if (typeof opts === 'function') {\n    fetch = opts;\n  } else {\n    // fetch option is availble\n    if (opts.fetch) {\n      // fetch is a funciton\n      if (typeof opts.fetch === 'function') {\n        fetch = opts.fetch;\n      } else {\n        // configuration\n        fetch = opts.fetch.fn || defaultFetch;\n        autoDecodeResponse = !!opts.fetch.autoDecodeResponse;\n      }\n    }\n\n    getPublicPath = opts.getPublicPath || opts.getDomain || defaultGetPublicPath;\n    getTemplate = opts.getTemplate || defaultGetTemplate;\n  }\n\n  return embedHTMLCache[url] || (embedHTMLCache[url] = fetch(url).then(function (response) {\n    return readResAsString(response, autoDecodeResponse);\n  }).then(function (html) {\n    var assetPublicPath = getPublicPath(url);\n\n    var _processTpl = processTpl(getTemplate(html), assetPublicPath),\n        template = _processTpl.template,\n        scripts = _processTpl.scripts,\n        entry = _processTpl.entry,\n        styles = _processTpl.styles;\n\n    return getEmbedHTML(template, styles, {\n      fetch: fetch\n    }).then(function (embedHTML) {\n      return {\n        template: embedHTML,\n        assetPublicPath: assetPublicPath,\n        getExternalScripts: function getExternalScripts() {\n          return _getExternalScripts(scripts, fetch);\n        },\n        getExternalStyleSheets: function getExternalStyleSheets() {\n          return _getExternalStyleSheets(styles, fetch);\n        },\n        execScripts: function execScripts(proxy, strictGlobal) {\n          var execScriptsHooks = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n          if (!scripts.length) {\n            return Promise.resolve();\n          }\n\n          return _execScripts(entry, scripts, proxy, {\n            fetch: fetch,\n            strictGlobal: strictGlobal,\n            beforeExec: execScriptsHooks.beforeExec,\n            afterExec: execScriptsHooks.afterExec\n          });\n        }\n      };\n    });\n  }));\n}\nexport function importEntry(entry) {\n  var opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var _opts$fetch3 = opts.fetch,\n      fetch = _opts$fetch3 === void 0 ? defaultFetch : _opts$fetch3,\n      _opts$getTemplate = opts.getTemplate,\n      getTemplate = _opts$getTemplate === void 0 ? defaultGetTemplate : _opts$getTemplate;\n  var getPublicPath = opts.getPublicPath || opts.getDomain || defaultGetPublicPath;\n\n  if (!entry) {\n    throw new SyntaxError('entry should not be empty!');\n  } // html entry\n\n\n  if (typeof entry === 'string') {\n    return importHTML(entry, {\n      fetch: fetch,\n      getPublicPath: getPublicPath,\n      getTemplate: getTemplate\n    });\n  } // config entry\n\n\n  if (Array.isArray(entry.scripts) || Array.isArray(entry.styles)) {\n    var _entry$scripts = entry.scripts,\n        scripts = _entry$scripts === void 0 ? [] : _entry$scripts,\n        _entry$styles = entry.styles,\n        styles = _entry$styles === void 0 ? [] : _entry$styles,\n        _entry$html = entry.html,\n        html = _entry$html === void 0 ? '' : _entry$html;\n\n    var setStylePlaceholder2HTML = function setStylePlaceholder2HTML(tpl) {\n      return styles.reduceRight(function (html, styleSrc) {\n        return \"\".concat(genLinkReplaceSymbol(styleSrc)).concat(html);\n      }, tpl);\n    };\n\n    var setScriptPlaceholder2HTML = function setScriptPlaceholder2HTML(tpl) {\n      return scripts.reduce(function (html, scriptSrc) {\n        return \"\".concat(html).concat(genScriptReplaceSymbol(scriptSrc));\n      }, tpl);\n    };\n\n    return getEmbedHTML(getTemplate(setScriptPlaceholder2HTML(setStylePlaceholder2HTML(html))), styles, {\n      fetch: fetch\n    }).then(function (embedHTML) {\n      return {\n        template: embedHTML,\n        assetPublicPath: getPublicPath(entry),\n        getExternalScripts: function getExternalScripts() {\n          return _getExternalScripts(scripts, fetch);\n        },\n        getExternalStyleSheets: function getExternalStyleSheets() {\n          return _getExternalStyleSheets(styles, fetch);\n        },\n        execScripts: function execScripts(proxy, strictGlobal) {\n          var execScriptsHooks = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n          if (!scripts.length) {\n            return Promise.resolve();\n          }\n\n          return _execScripts(scripts[scripts.length - 1], scripts, proxy, {\n            fetch: fetch,\n            strictGlobal: strictGlobal,\n            beforeExec: execScriptsHooks.beforeExec,\n            afterExec: execScriptsHooks.afterExec\n          });\n        }\n      };\n    });\n  } else {\n    throw new SyntaxError('entry scripts or styles should be array!');\n  }\n}","function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nmodule.exports = _arrayLikeToArray;","var arrayLikeToArray = require(\"./arrayLikeToArray\");\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}\n\nmodule.exports = _unsupportedIterableToArray;","function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    module.exports = _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    module.exports = _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nmodule.exports = _typeof;","<template>\r\n    <div class=\"demo-nav\">\r\n        <demo-row title=\"基本用法\">\r\n            <demo-line>\r\n                <pl-button-group>\r\n                    <pl-button label=\"打开Button页面\" @click=\"openButton\"/>\r\n                </pl-button-group>\r\n            </demo-line>\r\n            <pl-nav :nav=\"navigator\" height=\"300px\" width=\"100%\"/>\r\n        </demo-row>\r\n    </div>\r\n</template>\r\n\r\n<script lang=\"ts\">\r\n\r\n    import {defineComponent} from 'vue'\r\n    import {createNavigatorManager, NavRouteMode} from \"../../../src/packages/nav/NavigatorManager\";\r\n\r\n    const navigator = createNavigatorManager({\r\n        routerMode: NavRouteMode.hash,\r\n        defaultPage: {\r\n            title: '主页',\r\n            path: 'nav/nav-first-page',\r\n        },\r\n    })\r\n\r\n    navigator.init()\r\n\r\n    export default defineComponent({\r\n        name: \"demo-nav\",\r\n        data() {\r\n            return {\r\n                navigator,\r\n            }\r\n        },\r\n        methods: {\r\n            async openButton() {\r\n                await this.navigator.openTab({\r\n                    title: '页面二',\r\n                    path: 'nav/nav-second-page'\r\n                })\r\n            },\r\n        },\r\n    })\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n\r\n</style>","\r\n\r\n    import {defineComponent} from 'vue'\r\n    import {createNavigatorManager, NavRouteMode} from \"../../../src/packages/nav/NavigatorManager\";\r\n\r\n    const navigator = createNavigatorManager({\r\n        routerMode: NavRouteMode.hash,\r\n        defaultPage: {\r\n            title: '主页',\r\n            path: 'nav/nav-first-page',\r\n        },\r\n    })\r\n\r\n    navigator.init()\r\n\r\n    export default defineComponent({\r\n        name: \"demo-nav\",\r\n        data() {\r\n            return {\r\n                navigator,\r\n            }\r\n        },\r\n        methods: {\r\n            async openButton() {\r\n                await this.navigator.openTab({\r\n                    title: '页面二',\r\n                    path: 'nav/nav-second-page'\r\n                })\r\n            },\r\n        },\r\n    })\r\n","import { render } from \"./nav.vue?vue&type=template&id=63576cc6\"\nimport script from \"./nav.vue?vue&type=script&lang=ts\"\nexport * from \"./nav.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","function _iterableToArrayLimit(arr, i) {\n  if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nmodule.exports = _iterableToArrayLimit;","function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nmodule.exports = _arrayWithHoles;","function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nmodule.exports = _nonIterableRest;"],"sourceRoot":""}