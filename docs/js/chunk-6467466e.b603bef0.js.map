{"version":3,"sources":["webpack:///./story/pages/table/table-plc-editable.vue","webpack:///./story/pages/table/table-plc-editable.vue?89eb"],"names":["class","label","virtualFlag","disabled","editNodes","length","saveEdit","cancelEdit","data","virtual","associateFields","onDblClickRow","field","title","width","editable","isEditable","edit","row","type","name","style","required","rules","customRule","editRow","validator","rule","value","size","methods","tableNode","enableEdit","this","push","Promise","all","map","node","validate","validates","filter","Boolean","console","log","validateMessage","index","$message","error","forEach","closeEdit","render"],"mappings":"+8XACSA,MAAM,sB,iBAQsC,Q,iBACE,Q,6dATnD,eA0CM,MA1CN,EA0CM,CAzCF,eAwCW,Q,wBAvCP,iBAUU,CAVV,eAUU,Q,wBATN,iBAEe,CAFf,eAEe,GAFDC,MAAM,YAAU,C,wBAC1B,iBAAkC,CAAlC,eAAkC,G,WAAd,EAAAC,Y,qDAAA,EAAAA,YAAW,K,iCAEnC,eAKe,Q,wBAJX,iBAGkB,CAHlB,eAGkB,GAHAC,SAA0B,IAAhB,EAAAC,UAAUC,Q,yBAClC,iBAA6C,CAA7C,eAA6C,GAAjC,QAAO,EAAAC,UAAQ,C,wBAAE,iBAAI,C,0BACjC,eAA+C,GAAnC,QAAO,EAAAC,YAAU,C,wBAAE,iBAAI,C,uEAI/C,eA2BW,GA3BAC,KAAM,EAAAA,KACNC,QAAS,EAAAP,YACTQ,gBAAiB,EAAAA,gBACjB,eAAe,EAAAC,e,yBACtB,iBAAY,CAAZ,eAAY,GACZ,eAAuC,GAAlCC,MAAM,KAAKC,MAAM,KAAKC,MAAM,OACjC,eAAiC,GAA5BF,MAAM,OAAOC,MAAM,UACxB,eAIM,GAJDD,MAAM,OAAOC,MAAM,gBAAgBC,MAAM,MAAOC,SAAU,EAAAC,Y,CAC1CC,KAAI,gBACjB,gBADoBC,EACpB,EADoBA,IACpB,MADuB,C,eACvB,eAAgE,SAAzDC,KAAK,O,yCAAgBD,EAAIE,KAAI,GAAEC,MAAA,wB,yCAAVH,EAAIE,Y,qBAIxC,eAAwD,GAA7CR,MAAM,OAAOC,MAAM,OAAQE,UAAU,IAChD,eAA8C,GAAnCH,MAAM,OAAOC,MAAM,MAAMS,SAAA,KACpC,eAKE,GALSV,MAAM,OACNC,MAAM,cACNC,MAAM,MACLC,SAAU,EAAAC,WACVO,MAAO,EAAAC,Y,6BAGnB,eAAsC,GAA1BZ,MAAM,OAAOC,MAAM,QAC/B,eAAmC,GAAzBD,MAAM,OAAOC,MAAM,OAC7B,eAA4C,GAA1BD,MAAM,QAAQC,MAAM,OAEtC,eAAmC,GAAzBD,MAAM,OAAOC,MAAM,W,gMAU1B,GACXO,KAAM,qBACNZ,KAFW,WAGP,MAAO,CACHA,KAAA,EACAJ,UAAW,GACXF,aAAa,EACbQ,gBAAiB,CACbU,KAAM,QAEVJ,WAAY,gBAAES,EAAF,EAAEA,QAAF,QAAiBA,EAAQL,MAAQK,EAAQL,KAAKf,OAAS,GACnEmB,WAAY,CACRE,UAAW,SAACC,EAAMC,EAAOV,GAAd,OAAwBA,EAAIE,MAAQF,EAAIE,KAAKf,OAAS,EAC3Da,EAAIW,MAAqB,IAAbX,EAAIW,KAAkC,KAApB,kBAC9B,SAIlBC,QAAS,CACLnB,cADK,SACSoB,GACLA,EAAUd,OACXc,EAAUC,aACVC,KAAK7B,UAAU8B,KAAKH,KAGtBzB,SAPD,WAOY,oLACY6B,QAAQC,IAAI,EAAKhC,UAAUiC,KAAI,SAAAC,GAAG,OAAKA,EAAKC,eADxD,UACPC,EADO,OACsEC,OAAOC,WACtFF,EAAUnC,OAAS,GAFV,uBAGTsC,QAAQC,IAAIJ,GAHH,EAIgCA,EAAU,GAA5CK,EAJE,EAIFA,gBAAwBC,EAJtB,EAIeR,KAAOQ,MAC/B,EAAKC,SAASC,MAAd,WAAwBF,EAAQ,EAAhC,oBAA6CD,IALpC,0BASb,EAAKzC,UAAU6C,SAAQ,SAAAlB,GAAQ,OAAKA,EAAUzB,SAASyB,EAAUN,YACjE,EAAKrB,UAAU6C,SAAQ,SAAAlB,GAAQ,OAAKA,EAAUmB,eAC9C,EAAK9C,UAAY,GAXJ,+CAajBG,WApBK,WAqBD0B,KAAK7B,UAAU6C,SAAQ,SAAAlB,GACnBA,EAAUxB,gBAEd0B,KAAK7B,UAAY,MCzFjC,EAAO+C,OAASA,EAED","file":"js/chunk-6467466e.b603bef0.js","sourcesContent":["<template>\r\n    <div class=\"table-plc-editable\">\r\n        <demo-row>\r\n            <pl-form>\r\n                <pl-form-item label=\"是否开启虚拟滚动\">\r\n                    <pl-toggle v-model=\"virtualFlag\"/>\r\n                </pl-form-item>\r\n                <pl-form-item>\r\n                    <pl-button-group :disabled=\"editNodes.length === 0\">\r\n                        <pl-button @click=\"saveEdit\">保存编辑</pl-button>\r\n                        <pl-button @click=\"cancelEdit\">取消编辑</pl-button>\r\n                    </pl-button-group>\r\n                </pl-form-item>\r\n            </pl-form>\r\n            <pl-table :data=\"data\"\r\n                      :virtual=\"virtualFlag\"\r\n                      :associateFields=\"associateFields\"\r\n                      @dblclick-cell=\"onDblClickRow\">\r\n                <plc-index/>\r\n                <plc field=\"id\" title=\"编号\" width=\"50\"/>\r\n                <plc field=\"name\" title=\"普通文本列\"/>\r\n                <plc field=\"name\" title=\"普通文本列，编辑作用域插槽\" width=\"200\" :editable=\"isEditable\">\r\n                    <template v-slot:edit=\"{row}\">\r\n                        <input type=\"text\" v-model=\"row.name\" style=\"padding-left: 8px\">\r\n                    </template>\r\n                </plc>\r\n\r\n                <plc-input field=\"name\" title=\"禁用编辑\" :editable=\"false\"/>\r\n                <plc-input field=\"name\" title=\"文本框\" required/>\r\n                <plc-input field=\"size\"\r\n                           title=\"文本框值大于6可以编辑\"\r\n                           width=\"200\"\r\n                           :editable=\"isEditable\"\r\n                           :rules=\"customRule\"\r\n                />\r\n\r\n                <plc-number field=\"size\" title=\"数字框\"/>\r\n                <plc-date field=\"date\" title=\"日期\"/>\r\n                <plc-color-picker field=\"color\" title=\"颜色\"/>\r\n\r\n                <plc-rate field=\"star\" title=\"评分\"/>\r\n            </pl-table>\r\n        </demo-row>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    import data from \"../data/data-1.json\";\r\n\r\n\r\n    export default {\r\n        name: \"table-plc-editable\",\r\n        data() {\r\n            return {\r\n                data,\r\n                editNodes: [],\r\n                virtualFlag: false,\r\n                associateFields: {\r\n                    name: 'size',\r\n                },\r\n                isEditable: ({editRow}) => !!editRow.name && editRow.name.length > 5,\r\n                customRule: {\r\n                    validator: (rule, value, row) => !!row.name && row.name.length > 5 ?\r\n                        (!row.size && row.size !== 0) ? 'name 长度大于5情况下必填' : null\r\n                        : null\r\n                }\r\n            }\r\n        },\r\n        methods: {\r\n            onDblClickRow(tableNode) {\r\n                if (!tableNode.edit) {\r\n                    tableNode.enableEdit()\r\n                    this.editNodes.push(tableNode)\r\n                }\r\n            },\r\n            async saveEdit() {\r\n                const validates = (await Promise.all(this.editNodes.map(node => node.validate()))).filter(Boolean)\r\n                if (validates.length > 0) {\r\n                    console.log(validates)\r\n                    const {validateMessage, node: {index}} = validates[0]\r\n                    this.$message.error(`第${index + 1}条记录校验不通过，${validateMessage}`)\r\n                    return\r\n                }\r\n                // todo 网络保存逻辑\r\n                this.editNodes.forEach(tableNode => tableNode.saveEdit(tableNode.editRow))\r\n                this.editNodes.forEach(tableNode => tableNode.closeEdit())\r\n                this.editNodes = []\r\n            },\r\n            cancelEdit() {\r\n                this.editNodes.forEach(tableNode => {\r\n                    tableNode.cancelEdit()\r\n                })\r\n                this.editNodes = []\r\n            },\r\n        }\r\n    }\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n\r\n</style>","import { render } from \"./table-plc-editable.vue?vue&type=template&id=e3167aee\"\nimport script from \"./table-plc-editable.vue?vue&type=script&lang=js\"\nexport * from \"./table-plc-editable.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script"],"sourceRoot":""}